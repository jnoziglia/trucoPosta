<html>

<head>
<script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script defer>

  

  var socket = io.connect('http://localhost:8080');
  socket.emit('user_connected', {user: sessionStorage.getItem('username'), md5: sessionStorage.getItem('md5') });
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });

  socket.on('file', function(data) {
  	//console.log(data.file);
  	$('.main').html('');
  	$('.main').append(data.file);
  });

  socket.on('new_user_created', function(data) {
  	sessionStorage.setItem('username', data.username);
  	sessionStorage.setItem('md5', data.md5);

  });

  socket.on('user_conflict', function(data) {
  	sessionStorage.clear();
  });

  socket.on('user_exists', function(data) {
  	alert('User already exists');
  });

  socket.on('cambio_en_partidas_recibido',function(data) {
    //window.location.href = '/partidas/'+data.partida;
  });


  function newUser() {
  	socket.emit('new_user', {username: $('#username').val()});
  }

  function crearPartida() {
    $.ajax({
      type: "POST",
      url: "/partidas",
      data: {username: sessionStorage.getItem('username'), md5: sessionStorage.getItem('md5')}
    })
      .done(function( data ) {
        var partida = data.partida; 
        socket.emit('nueva_partida');
        $('.main').html(data.file);
        $('#jugador1').text(partida.jugador1);
      });
  }

</script>

<script type="text/javascript">

</script>
<link rel="stylesheet" type="text/css" href="./css">
</head>
<body>
<div class="partida_id"></div>
		
	<div class="main">
		

		<!--<form method="post" action="#">

		user: <input type="text" name="user" id="user"><br />
		password: <input type="text" name="password" id="password"><br />
		
		<a onclick="sendLogin();" href="javascript:void(0);">Login</a>
		</form>-->
	</div>
</body>

</html>